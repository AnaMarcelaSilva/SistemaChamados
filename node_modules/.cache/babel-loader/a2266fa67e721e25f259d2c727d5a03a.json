{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\anama\\\\Documents\\\\sigos\\\\src\\\\contexts\\\\auth.js\",\n    _s = $RefreshSig$();\n\nimport { useState, createContext, useEffect } from 'react';\nimport firebase from '../services/firebaseConnection';\nimport { toast } from 'react-toastify';\nimport SignUp from '../pages/SignUp'; //Criando uma constante para ultilizar o creatContext\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\n\nfunction AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const [loadingAuth, setLoadingAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [cargo, setCargo] = useState(\"\"); //Salvando as insformações do locarStrage na constante storegeUser quando a págiana é aberta.\n\n  useEffect(() => {\n    function loadStorage() {\n      const storageUser = localStorage.getItem('SistemaUser'); //Transformando o conteudo da constante em objeto novamente e setando o valor da mesma na constante user.\n\n      if (storageUser) {\n        setUser(JSON.parse(storageUser));\n        setLoading(false);\n      }\n\n      setLoading(false);\n    }\n\n    loadStorage();\n  }, []); //Realizando o login de um usuário\n\n  async function signIn(email, password) {\n    setLoadingAuth(true);\n    await firebase.auth().signInWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      const userProfile = await firebase.firestore().collection('users').doc(uid).get();\n      let data = {\n        uid: uid,\n        nome: userProfile.data().nome,\n        avatarUrl: userProfile.data().avatarUrl,\n        cargo: userProfile.data().cargo,\n        rm: userProfile.data().rm,\n        email: value.user.email\n      };\n      setUser(data);\n      storageUser(data);\n      setLoadingAuth(false);\n      toast.success('Bem-vindo(a) de volta!');\n    }).catch(error => {\n      console.log(error);\n      toast.error('Ops, algo deu errado!');\n      setLoadingAuth(false);\n    });\n  } //Cadastrando um novo usuario\n\n\n  async function signUp(email, password, nome, cargo, rm) {\n    setLoadingAuth(true);\n    await firebase.auth().createUserWithEmailAndPassword(email, password).then(async value => {\n      let uid = value.user.uid;\n      await firebase.firestore().collection('users').doc(uid).set({\n        nome: nome,\n        avatarUrl: null,\n        email: email,\n        rm: rm,\n        cargo: cargo\n      }).then(() => {\n        let data = {\n          uid: uid,\n          nome: nome,\n          email: value.user.email,\n          avatarUrl: null,\n          rm: rm,\n          cargo: value.user.cargo\n        };\n        setUser(data);\n        storageUser(data);\n        setLoadingAuth(false);\n        toast.success('Bem-vindo(a) a plataforma!');\n      });\n    }) //Caso a ciração do usuário não seja bem sucedida, mostrar o erro no console.\n    .catch(error => {\n      console.log(error);\n      toast.error('Ops, algo deu errado!');\n      setLoadingAuth(false);\n    });\n  }\n\n  function storageUser(data) {\n    localStorage.setItem('SistemaUser', JSON.stringify(data));\n  } //Logout do usuario\n\n\n  async function signOut() {\n    await firebase.auth().signOut();\n    localStorage.removeItem('SistemaUser');\n    setUser(null);\n  }\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      signed: !!user,\n      user,\n      loading,\n      signUp,\n      signOut,\n      signIn,\n      loadingAuth,\n      setUser,\n      storageUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 3\n  }, this);\n}\n\n_s(AuthProvider, \"hLWJLpt0PQqH02dP8ptXs19+Gqg=\");\n\n_c = AuthProvider;\nexport default AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["useState","createContext","useEffect","firebase","toast","SignUp","AuthContext","AuthProvider","children","user","setUser","loadingAuth","setLoadingAuth","loading","setLoading","cargo","setCargo","loadStorage","storageUser","localStorage","getItem","JSON","parse","signIn","email","password","auth","signInWithEmailAndPassword","then","value","uid","userProfile","firestore","collection","doc","get","data","nome","avatarUrl","rm","success","catch","error","console","log","signUp","createUserWithEmailAndPassword","set","setItem","stringify","signOut","removeItem","signed"],"sources":["C:/Users/anama/Documents/sigos/src/contexts/auth.js"],"sourcesContent":["\r\nimport { useState, createContext, useEffect } from 'react';\r\nimport firebase from '../services/firebaseConnection';\r\nimport { toast } from 'react-toastify';\r\n\r\n  import SignUp from '../pages/SignUp';\r\n\r\n\r\n//Criando uma constante para ultilizar o creatContext\r\nexport const AuthContext = createContext({});\r\n\r\n\r\nfunction AuthProvider({ children }){\r\n  const [user, setUser] = useState(null);\r\n  const [loadingAuth, setLoadingAuth] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [cargo, setCargo] = useState(\"\");\r\n\r\n  //Salvando as insformações do locarStrage na constante storegeUser quando a págiana é aberta.\r\n  useEffect(()=>{\r\n\r\n    function loadStorage(){\r\n      const storageUser = localStorage.getItem('SistemaUser');\r\n\r\n      //Transformando o conteudo da constante em objeto novamente e setando o valor da mesma na constante user.\r\n      if(storageUser){\r\n        setUser(JSON.parse(storageUser));\r\n        setLoading(false);\r\n      }\r\n  \r\n      setLoading(false);\r\n    }\r\n    \r\n    loadStorage();\r\n\r\n  }, [])\r\n\r\n  //Realizando o login de um usuário\r\n  async function signIn(email, password){\r\n    setLoadingAuth(true);\r\n\r\n    await firebase.auth().signInWithEmailAndPassword(email, password)\r\n    .then(async (value) => {\r\n      let uid = value.user.uid;\r\n\r\n      const userProfile = await firebase.firestore().collection('users').doc(uid).get();\r\n\r\n      let data = {\r\n        uid: uid,\r\n        nome: userProfile.data().nome,\r\n        avatarUrl: userProfile.data().avatarUrl,\r\n        cargo: userProfile.data().cargo,\r\n        rm: userProfile.data().rm,\r\n        email: value.user.email\r\n      }\r\n\r\n      setUser(data);\r\n      storageUser(data);\r\n      setLoadingAuth(false);\r\n      toast.success('Bem-vindo(a) de volta!');\r\n\r\n    })\r\n    .catch((error)=>{\r\n      console.log(error);\r\n      toast.error('Ops, algo deu errado!');\r\n      setLoadingAuth(false);\r\n    })\r\n\r\n  }\r\n\r\n  //Cadastrando um novo usuario\r\n  async function signUp(email, password, nome, cargo, rm){\r\n    setLoadingAuth(true);\r\n\r\n    await firebase.auth().createUserWithEmailAndPassword(email, password)\r\n    .then( async (value)=>{\r\n      let uid = value.user.uid;\r\n\r\n      await firebase.firestore().collection('users')\r\n      .doc(uid).set({\r\n        nome: nome,\r\n        avatarUrl: null,\r\n        email: email,\r\n        rm: rm,\r\n        cargo: cargo,\r\n      })\r\n      .then( () => {\r\n\r\n        let data = {\r\n          uid: uid,\r\n          nome: nome,\r\n          email: value.user.email,\r\n          avatarUrl: null,\r\n          rm: rm,\r\n         cargo: value.user.cargo\r\n        };\r\n\r\n        setUser(data);\r\n        storageUser(data);\r\n        setLoadingAuth(false);\r\n        toast.success('Bem-vindo(a) a plataforma!');\r\n\r\n      })\r\n\r\n    })\r\n\r\n    //Caso a ciração do usuário não seja bem sucedida, mostrar o erro no console.\r\n    .catch((error)=>{\r\n      console.log(error);\r\n      toast.error('Ops, algo deu errado!');\r\n      setLoadingAuth(false);\r\n\r\n    })\r\n\r\n  }\r\n\r\n  function storageUser(data){\r\n    localStorage.setItem('SistemaUser', JSON.stringify(data));\r\n  }\r\n\r\n //Logout do usuario\r\n async function signOut(){\r\n  await firebase.auth().signOut();\r\n  localStorage.removeItem('SistemaUser');\r\n  setUser(null);\r\n}\r\n\r\n\r\nreturn(\r\n  <AuthContext.Provider \r\n  value={{ \r\n    signed: !!user,  \r\n    user, \r\n    loading, \r\n    signUp,\r\n    signOut,\r\n    signIn,\r\n    loadingAuth,\r\n    setUser,\r\n    storageUser\r\n  }}\r\n  >\r\n    {children}\r\n  </AuthContext.Provider>\r\n)\r\n}\r\n\r\nexport default AuthProvider;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}